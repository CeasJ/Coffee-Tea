<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" >
<head>
    <meta charset="UTF-8">
    <title>Report</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://d3js.org/d3.v6.min.js"></script>

</head>
<body>
    <h3>Revenue</h3>
    <h4 th:text="${revenue}"></h4>
    <h3>Total Order</h3>
    <h4 th:text="${total}"></h4>
    <h3>Total Product Has Sold</h3>
    <h4 th:text="${totalProductHasSold}"></h4>
    <h1>Product has sold</h1>
    <canvas id="countProductHasSold" width="100" height="50"></canvas>
    
    <button>PDF</button>
    <h1>Total revenue</h1>

	<select name="time" id="time">
		<option value="week">Week</option>
		<option value="month">Month</option>
		<option value="year">Year</option>
	</select>

    <canvas id="totalRevenue" width="100" height="50"></canvas>
	<form th:action="@{|/getByDate|}">
		<input type="date" name="startDate" id="startDate">
		<input type="date" name="endDate" id="endDate">
		<button type="submit">Submit</button>
		<table>
			<thead>
				<tr>
					<th>Day</th>
					<th>Revenue</th>
				</tr>
			</thead>
			<tbody th:each="result:${totalRevenue}">
				<tr>
					<td th:text="${result[0]}"></td>
					<td th:text="${result[1]}"></td>
				</tr>
			</tbody>
		</table>
	</form>


<script th:inline="javascript">
    function getRandomColor() {
    	const colors = [
				"#FF5733", "#33FF57", "#5733FF", "#FF33A8", "#33A8FF",
				"#FFC733", "#33FFC7", "#C733FF", "#FF33E5", "#33E5FF",
				"#FF8233", "#33FF82", "#8233FF", "#FF33FA", "#33FAFF",
				"#FF3366", "#33FF66", "#3366FF", "#FF6699", "#6699FF",
				"#FF6699", "#99FF66", "#66FF99", "#FF9966", "#66FF99",
				'rgba(255, 99, 132, 0.2)','rgba(255, 159, 64, 0.2)',
     		 	'rgba(255, 205, 86, 0.2)','rgba(75, 192, 192, 0.2)',
     		    'rgba(54, 162, 235, 0.2)','rgba(153, 102, 255, 0.2)',
      			'rgba(201, 203, 207, 0.2)'
			];
			const randomColor = colors[Math.floor(Math.random() * colors.length)];
			return randomColor;
    }
    // biểu đồ cột
    var productHasSold = /*[[${countProductHasSold}]]*/[];
    var charty = document.getElementById('countProductHasSold').getContext('2d');
		var columnCountProductSold = new Chart(charty, {
			type: 'bar',
			data: {
				labels: productHasSold.map(row => row[1]),
				datasets: [{
					label: 'Quantity',
					data: productHasSold.map(row => row[2]),
					backgroundColor: getRandomColor(),
					borderColor: 'rgba(75, 192, 192, 1)',
					borderWidth: 1
				}]
			},
			options: {
				scales: {
					y: {
						beginAtZero: true,
					}
				}
			}
		});
        
        // biểu đồ đường tổng tiền
        var dataRevenue = /*[[${totalRevenue}]]*/[];
		var chartr = document.getElementById('totalRevenue').getContext('2d');
		var columnRevenue = new Chart(chartr, {
			type: 'line',
			data: {
				labels: dataRevenue.map(row => row[0]),
				datasets: [
					{
						label: 'Revenue',
						data: dataRevenue.map(row => row[1]),
						backgroundColor: getRandomColor(),
						borderColor: 'rgba(75, 192, 192, 1)',
						borderWidth: 1,
						fill: false
					}
				]
			},
			options: {
				scales: {
					y: {
						beginAtZero: true,
					}
				}
			}
		});
</script>
</body>
</html>