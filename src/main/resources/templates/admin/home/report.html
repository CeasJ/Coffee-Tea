<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <meta name="description" content=""/>
    <meta name="author" content=""/>
    <title>Report - Dream Admin</title>

    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet"/>

    <link href="/css/admin/admin.css" rel="stylesheet"/>

    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script src="https://d3js.org/d3.v6.min.js"></script>
</head>

<body class="sb-nav-fixed">
<div th:replace="~{/admin/component/header.html}"></div>
<div id="layoutSidenav">
    <div id="layoutSidenav_nav">
        <div th:replace="~{/admin/component/sidebar.html}"></div>
    </div>
    <div id="layoutSidenav_content">
        <main>
            <div class="container-fluid">
                <div class="card mb-4">
                    <div class="card-header">
                        <h3>Report</h3>
                    </div>
                    <div class="card-body">
                        <table id="datatablesSimple">
                            <thead>
                            <tr>
                                <th>Metric</th>
                                <th>Value</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>Revenue</td>
                                <td th:text="${revenue}"></td>
                            </tr>
                            <tr>
                                <td>Total Order</td>
                                <td th:text="${total}"></td>
                            </tr>
                            <tr>
                                <td>Total Product Has Sold</td>
                                <td th:text="${totalProductHasSold}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>


            <div class="container-fluid my-4">
                <div class="card mb-4">
                    <div class="card-header">
                        <h3>Total Revenue</h3>
                    </div>
                </div>
                <form th:action="@{|getByDate|}">
                    <input type="date" id="startDate" name="startDate">
                    <input type="date" id="endDate" name="endDate">
                    <button type="submit" class="btn btn-outline-success">Submit</button>
                </form>

                <a th:href="@{|week|}" class="btn btn-outline-success">Week</a>
                <a th:href="@{|month|}" class="btn btn-outline-success">Month</a>

                <canvas id="totalRevenue" width="100" height="30"></canvas>
            </div>


            <div class="container-fluid ">
                <div class="card mb-4">
                    <div class="card-header">
                        <h3>Product Has Sold</h3>
                    </div>
                </div>
                <canvas id="countProductHasSold" width="100" height="30"></canvas>
            </div>


            <div class="container-fluid ">
                <div class="card mb-4">
                    <div class="card-header">
                        <h3>Category</h3>
                    </div>
                </div>
                <canvas id="productHasSoldByCategory" width="100" height="30"></canvas>
            </div>




        </main>
        <div th:replace="~{/admin/component/footer.html}"></div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        crossorigin="anonymous"></script>
<script src="js/admin/scripts.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js"
        crossorigin="anonymous"></script>

<script th:inline="javascript">
    function getRandomColor() {
        const colors = [
                "#FF5733", "#33FF57", "#5733FF", "#FF33A8", "#33A8FF",
                "#FFC733", "#33FFC7", "#C733FF", "#FF33E5", "#33E5FF",
                "#FF8233", "#33FF82", "#8233FF", "#FF33FA", "#33FAFF",
                "#FF3366", "#33FF66", "#3366FF", "#FF6699", "#6699FF",
                "#FF6699", "#99FF66", "#66FF99", "#FF9966", "#66FF99",
                'rgba(255, 99, 132, 0.2)','rgba(255, 159, 64, 0.2)',
                  'rgba(255, 205, 86, 0.2)','rgba(75, 192, 192, 0.2)',
                 'rgba(54, 162, 235, 0.2)','rgba(153, 102, 255, 0.2)',
                  'rgba(201, 203, 207, 0.2)'
            ];
            const randomColor = colors[Math.floor(Math.random() * colors.length)];
            return randomColor;
    }


    var productHasSold = /*[[${countProductHasSold}]]*/[];
    var charty = document.getElementById('countProductHasSold').getContext('2d');
        var columnCountProductSold = new Chart(charty, {
            type: 'bar',
            data: {
                labels: productHasSold.map(row => row[1]),
                datasets: [{
                    label: 'Quantity',
                    data: productHasSold.map(row => row[2]),
                    backgroundColor: getRandomColor(),
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        stepSize: 5
                    }
                }
            }
        });

    var productHasSoldByCategory = /*[[${productHasSoldByCategory}]]*/[];
    var charty = document.getElementById('productHasSoldByCategory').getContext('2d');
        var columnCountProductSold = new Chart(charty, {
            type: 'bar',
            data: {
                labels: productHasSoldByCategory.map(row => row[0]),
                datasets: [{
                    label: 'Quantity',
                    data: productHasSoldByCategory.map(row => row[1]),
                    backgroundColor: getRandomColor(),
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        stepSize: 5
                    }
                }
            }
        });



        var dataRevenue = /*[[${totalRevenue}]]*/[];
        var chartr = document.getElementById('totalRevenue').getContext('2d');
        var columnRevenue = new Chart(chartr, {
            type: 'line',
            data: {
                labels: dataRevenue.map(row => row[0]),
                datasets: [
                    {
                        label: 'Revenue',
                        data: dataRevenue.map(row => row[1]),
                        backgroundColor: getRandomColor(),
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1,
                        fill: false
                    }
                ]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                    }
                }
            }
        });


</script>
</body>

</html>